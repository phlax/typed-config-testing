{"$schema": "http://json-schema.org/draft-04/schema#", "properties": {"update_frequency": {"type": "integer", "description": "How often the priority load should be updated based on previously attempted priorities. Useful\n to allow each priorities to receive more than one request before being excluded or to reduce\n the number of times that the priority load has to be recomputed.\n\n For example, by setting this to 2, then the first two attempts (initial attempt and first\n retry) will use the unmodified priority load. The third and fourth attempt will use priority\n load which excludes the priorities routed to with the first two attempts, and the fifth and\n sixth attempt will use the priority load excluding the priorities used for the first four\n attempts.\n\n Must be greater than 0."}}, "additionalProperties": true, "type": "object", "description": "[#protodoc-title: Previous priorities retry selector]\n\nA retry host selector that attempts to spread retries between priorities, even if certain\n priorities would not normally be attempted due to higher priorities being available.\n\n As priorities get excluded, load will be distributed amongst the remaining healthy priorities\n based on the relative health of the priorities, matching how load is distributed during regular\n host selection. For example, given priority healths of {100, 50, 50}, the original load will be\n {100, 0, 0} (since P0 has capacity to handle 100% of the traffic). If P0 is excluded, the load\n changes to {0, 50, 50}, because P1 is only able to handle 50% of the traffic, causing the\n remaining to spill over to P2.\n\n Each priority attempted will be excluded until there are no healthy priorities left, at which\n point the list of attempted priorities will be reset, essentially starting from the beginning.\n For example, given three priorities P0, P1, P2 with healthy % of 100, 0 and 50 respectively, the\n following sequence of priorities would be selected (assuming update_frequency = 1):\n Attempt 1: P0 (P0 is 100% healthy)\n Attempt 2: P2 (P0 already attempted, P2 only healthy priority)\n Attempt 3: P0 (no healthy priorities, reset)\n Attempt 4: P2\n\n In the case of all upstream hosts being unhealthy, no adjustments will be made to the original\n priority load, so behavior should be identical to not using this plugin.\n\n Using this PriorityFilter requires rebuilding the priority load, which runs in O(# of\n priorities), which might incur significant overhead for clusters with many priorities.\n [#extension: envoy.retry_priorities.previous_priorities]"}